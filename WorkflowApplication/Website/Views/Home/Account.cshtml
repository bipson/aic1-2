@model Double

@if (false)
{
    <script src="@Url.Content("~/Scripts/jquery-1.8.3-vsdoc.js")" type="text/javascript"></script>
}

<script type="text/javascript">
    $(function () {
        @foreach (var message in ViewBag.Messages ?? new String[0])
        {
            @:DisplayMessage('@message');
        }

        $('#unregister').button().click(function () {
            $('#dialog-@(Model == 0.0 ? "unregister" : "payment")').dialog('open');
        });

        $("#dialog-unregister").dialog({
            resizable: false,
            width: 400,
            modal: true,
            autoOpen: false,
            buttons: {
                Unregister: function () {
                    $(this).dialog('close');
                    $('#unregister').prop('disabled', 'true');
                    $.post('@Url.Action("Unregister")', '', function (data) {
                        $('#unregister').prop('disabled', 'false');
                        if (data.Success) {
                            window.location.replace(data.RedirectURL);
                        } else {
                            $.each(data, function (idx, message) {
                                DisplayMessage(message.Error);
                            });
                        }
                    });
                },
                Cancel: function () {
                    $(this).dialog('close');
                }
            }
        });

        $('#dialog-payment').dialog({
            resizable: false,
            width: 400,
            modal: true,
            autoOpen: false,
            buttons: {
                Ok: function () {
                    $(this).dialog('close');
                }
            }
        });
    });
</script>

<div>Click the button below to unregister from the application.</div>
<button id="unregister">Unregister</button>

<div id="dialog-unregister" title="Unregister from the analyzer?">
    <p>
        Do you really want to unregister from the Twitter Sentiment Analyzer?
    </p>
</div>

<div id="dialog-payment" title="Pending payment">
    <p>
        You have <b>@Model€</b> of outstanding payment. You can only unregister when all your bills have been paid.
    </p>
</div>